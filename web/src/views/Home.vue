<template>
  <div>
    <swiper :options="swiperOption" ref="mySwiper">
      <swiper-slide>
        <img class="w-100" src="../assets/images/88f7acf6451d67170ba172091af7fa42.jpeg" alt="">
      </swiper-slide>
      <swiper-slide>
        <img class="w-100" src="../assets/images/3da84d86175a05e5b9fd62beeff35e13.jpeg" alt="">
      </swiper-slide>
      <swiper-slide>
        <img class="w-100" src="../assets/images/ae37bd718aa19d57ae7c80e0843aef86.jpeg" alt="">
      </swiper-slide>
      <div class="swiper-pagination pagination-home text-right px-3 pb-2"  slot="pagination"></div>
    </swiper>

    <!-- start nav icon -->
    <div class="nav-icons bg-white mt-3  text-center pt-3 text-dark-1">
      <div class="d-flex flex-wrap">
        <div class="nav-item mb-3" v-for="n in 10" :key="n">
          <i class="sprite sprite-news"></i>
          <div class="py-2">爆料站</div>
        </div>
      </div>
      <div class="bg-light py-2 fs-sm">
        <i class="sprite sprite-arrow mr-2"></i>
        <span>收起</span>
      </div>
    </div>
    <!-- end nav icon -->
    <m-list-card icon="caidan1" title="新闻资讯test测试" :categories="newsCats">
      <template #items="{category}">
        <router-link tag="div" :to="`/articles/${news._id}`" class="py-2 fs-lg d-flex" v-for="(news, index) in category.newsList" :key="index">
          <span class="text-info">{{news.categoryName}}</span>
          <span class="px-2">|</span>
          <span class="flex-1 text-dark-1 text-ellipsis pr-2">{{news.title}}</span>
          <span class="text-grey-1 fs-sm">{{news.createdAt | date}}</span>
        </router-link>
      </template>
    </m-list-card>

    <m-list-card icon="yingxiongxiangqing" title="英雄列表" :categories="heroCats">
      <template #items="{category}">
        <div class="d-flex flex-wrap" style="margin: 0 -0.5rem">
          <router-link tag="div" :to="`/heroes/${hero._id}`" class="p-2 text-center" style="width: 20%" v-for="(hero, index) in category.heroList" :key="index">
            <img :src="hero.avatar" alt="" class="w-100">
            <div>{{hero.name}}</div>
          </router-link>
        </div>
        
      </template>
    </m-list-card>

    <m-crad icon="caidan1" title="视频列表">
      <router-link tag="div" :to="`/videos/${item._id}`" class="py-2" v-for="item in videoList" :key="item._id">{{item.name}}</router-link>
    </m-crad>

    <m-crad icon="caidan1" title="支付模块">
      <!-- <router-link tag="div" :to="`/videos/${item._id}`" class="py-2" v-for="item in videoList" :key="item._id">{{item.name}}</router-link> -->
      <div class="components-input-demo-presuffix">
        <!-- <a-input ref="userNameInput" v-model="alipayinfo.userName" placeholder="Basic usage">
          <a-icon slot="prefix" type="user" />
          <a-tooltip slot="suffix" title="Extra information">
            <a-icon type="info-circle" style="color: rgba(0,0,0,.45)" />
          </a-tooltip>
        </a-input>
        <br />
        <br /> -->
        <a-input prefix="￥" suffix="RMB" v-model.number="alipayinfo.totalAmount" />
        <a-input prefix="" suffix="tradeNo" placeholder="必填，随便填不能重复" v-model.number="alipayinfo.tradeNo" />
        <div class="text-center mt-3">
          <a-button type="primary" @click="aliPay">
            支付
          </a-button>
        </div>
        <!-- <div> -->
        <a-modal class="qrcode-content" v-if="isPayqrcode" title="支付二维码" @ok="handleOk">
          <div class="code text-center" id="qrcode" ref="qrcode"  @click="handleQrcode"></div>
        </a-modal>
        <!-- </div> -->
      </div>
    </m-crad>

    <m-crad icon="caidan1" title="抖音无水印视频解析" @click="playAudio">
      <div class="components-input-demo-presuffix">
        <a-input v-model="analysisurl.url" />
        <div class="text-center mt-3">
          <a-button class="" type="primary" @click="analysis">解析</a-button>
        </div>
        <div>dy视频链接：{{nodedata.dyurl}}</div>
        <div>视频链接：{{nodedata.url}}</div>
        <div>音频链接：{{nodedata.music}}</div>
        <!-- <div>{{analysisurl.dyurl}}</div>
        <div>{{analysisurl.dyurl}}</div> -->
      </div>
    </m-crad>

    <m-crad icon="caidan1" title="文字转语音测试111" @click="playAudio">
      <div class="text-center mt-3">
        <a-button type="primary" @click="playAudio">
          播放
        </a-button>
      </div>
    </m-crad>
  </div>
</template>
<script>
import dayjs from 'dayjs'
// import alipayf2f from 'alipay-ftof';
import QRCode from 'qrcodejs2'

export default {
  data() {
    return {
      swiperOption: {
        // some swiper options/callbacks
        // 所有的参数同 swiper 官方 api 参数
        // ...
        pagination:{
          el: ".pagination-home"
        }
      },
      newsCats: [],
      heroCats: [],
      videoList: [],
      alipayinfo:{
        tradeNo: "",      // 必填 商户订单主键, 就是你要生成的
        subject: "女装",      // 必填 商品概要
        totalAmount: 0.01,    // 必填 多少钱
        body: "黑丝吊带小蜡烛", // 可选 订单描述, 可以对交易或商品进行一个详细地描述，比如填写"购买商品2件共15.00元"
        timeExpress: 5       // 可选 支付超时, 默认为5分钟
      },
      isPayqrcode:false,
      qrcode:'',
      payResult: {},
      analysisurl:{
        dyurl:'',
        url:'',
        cover:'',
        music:'',
        title:'',
      },
      nodedata:{
        dyurl:'',
        url:'',
        cover:'',
        music:'',
        title:'',
      },
    }
  },
  computed: {
    swiper() {
      return this.$refs.mySwiper.swiper
    }
  },
  filters: {
    date(val){
      return dayjs(val).format('MM/DD')
    }
  },
  created() {
    this.fetchNewsCats();
    this.fetchHeroCats();
    this.fetchVideo();
  },
  mounted() {
    console.log('alipay');
    console.log('xigua111');
    this.swiper.slideTo(3, 1000, false)
  },
  methods: {
    async fetchNewsCats(){
      const res = await this.$http.get('news/list');
      this.newsCats = res.data;
    },
    async fetchHeroCats(){
      const res = await this.$http.get('heroes/list');
      this.heroCats = res.data;
    },
    async fetchVideo(){
      const res = await this.$http.get('videos/list');
      this.videoList = res.data;
    },
    async aliPay(){
      console.log('alipay');
      const res = await this.$http.post('alipay', this.alipayinfo)
      this.payResult = res.data
      console.log(this.payResult);
      console.log(this.payResult.qr_code);
      if (this.payResult.code === '10000') {
        // this.qrcode = this.payResult.qr_code;
        console.log(this.payResult);
        console.log(this.payResult.qr_code);
        await this.payOrder()
      }
    },
    // 展示二维码
    async payOrder () {
      // 二维码内容,一般是由后台返回的跳转链接,这里是写死的一个链接
      // this.qrcode = ''
      // 使用$nextTick确保数据渲染
      // this.$nextTick(() => {
        this.isPayqrcode = true
        await this.crateQrcode()
        
        await this.alipayPolling()
      // })
    },
    // 生成二维码
    async crateQrcode () {
      this.qr = await new QRCode('qrcode', {
        width: 150,
        height: 150, // 高度
        text: this.payResult.qr_code // 二维码内容
        // render: 'canvas' // 设置渲染方式（有两种方式 table和canvas，默认是canvas）
        // background: '#f0f'
        // foreground: '#ff0'
      })
    },
    // 开始轮询
    async alipayPolling(){
      // 二维码生成接口
      this.intervalwx = window.setInterval(()=>{
        setTimeout(this.checkPay(),0)
      },1000);
    },
    async checkPay(){
      //调取支付状态的接口，支付成功返回200
      const res = await this.$http.post('checkPay', this.alipayinfo)
      const that = this;
      if (res.data.code == 200) {
        clearInterval(that.intervalwx)
        that.intervalwx = null
      }
    },
    // 关闭弹框,清除已经生成的二维码
    closeCode () {
      this.$refs.qrcode.innerHTML = ''
    },
    handleOk(e) {
      console.log(e);
      this.isPayqrcode = false;
      this.$refs.qrcode.innerHTML = '';
    },
    handleQrcode() {
      window.open(`${this.payResult.qr_code}`)
    },

    async analysis(){
      const res = await this.$http.post('analysisurl', this.analysisurl)
      if (res.data.code) {
        this.nodedata = res.data
      } else {
        this.nodedata.dyurl = res.data
        // this.analysisurl.dyurl = res.data
      }
    },

    playAudio(){
      console.log('123');
      // var msg = new SpeechSynthesisUtterance('Help me with this code please?'); 

      // msg.pitch = 0; 

      // msg.rate = .6; 

      // window.speechSynthesis.speak(msg); 







      var msg = new SpeechSynthesisUtterance(); 

      var voices = window.speechSynthesis.getVoices(); 

      msg.voice = voices[10]; // Note: some voices don't support altering params 

      msg.voiceURI = 'native'; 

      msg.volume = 1; // 0 to 1 

      msg.rate = 1.2; // 0.1 to 10 

      msg.pitch = 0; //0 to 2 

      msg.text = '上海市公共数据开放暂行办法第一章　总则第一条（目的和依据） 为了促进和规范本市公共数据开放和利用，提升政府治理能力和公共服务水平，推动数字经济发展，根据相关法律法规，结合本市实际，制定本办法。第二条（适用范围） 本市行政区域内公共数据开放及其相关管理活动，适用本办法。 涉及国家秘密的公共数据管理，按照相关保密法律、法规的规定执行。第三条（定义） 本办法所称公共数据，是指本市各级行政机关以及履行公共管理和服务职能的事业单位（以下统称公共管理和服务机构）在依法履职过程中，采集和产生的各类数据资源。 本办法所称公共数据开放，是指公共管理和服务机构在公共数据范围内，面向社会提供具备原始性、可机器读取、可供社会化再利用的数据集的公共服务。第四条（工作原则） 本市公共数据开放工作，遵循“需求导向、安全可控、分级分类、统一标准、便捷高效”的原则。第五条（职责分工） 市政府办公厅负责推动、监督本市公共数据开放工作。 市经济信息化部门负责指导协调、统筹推进本市公共数据开放、利用和相关产业发展。 市大数据中心负责本市公共数据统一开放平台（以下简称开放平台）的建设、运行和维护，并制订相关技术标准。 区人民政府确定的部门负责指导、推进和协调本行政区域内公共数据开放工作。 其他公共管理和服务机构根据相关法律、法规和规章，做好公共数据开放的相关工作。第六条（数据安全保护） 市、区人民政府及各相关部门在公共数据开放过程中，应当落实数据安全管理要求，采取措施保护商业秘密和个人隐私，防止公共数据被非法获取或者不当利用。第七条（协调机制） 市人民政府建立健全公共数据开放工作的协调机制，协调解决公共数据开放的重大事项。第八条（专家委员会） 市经济信息化部门应当建立由高校、科研机构、企业、相关部门的专家组成的公共数据开放专家委员会。 公共数据开放专家委员会负责研究论证公共数据开放中的疑难问题，评估公共数据利用风险，对公共数据开放工作提出专业建议。第二章　开放机制第九条（数据开放主体） 市人民政府各部门、区人民政府以及其他公共管理和服务机构（以下统称数据开放主体）分别负责本系统、本行政区域和本单位的公共数据开放。 对于纳入开放范围的公共数据,应当在本市公共数据资源目录中列明数据开放主体。第十条（开放重点） 市经济信息化部门应当根据本市经济社会发展需要，确定年度公共数据开放重点。与民生紧密相关、社会迫切需要、行业增值潜力显著和产业战略意义重大的公共数据，应当优先纳入公共数据开放重点。 市经济信息化部门在确定公共数据开放重点时，应当听取相关行业主管部门和社会公众的意见。 自然人、法人和非法人组织可以通过开放平台对公共数据的开放范围提出需求和意见建议。第十一条（分级分类） 市经济信息化部门应当会同市大数据中心结合公共数据安全要求、个人信息保护要求和应用要求等因素，制定本市公共数据分级分类规则。数据开放主体应当按照分级分类规则，结合行业、区域特点，制定相应的实施细则，并对公共数据进行分级分类，确定开放类型、开放条件和监管措施。 对涉及商业秘密、个人隐私，或者法律法规规定不得开放的公共数据，列入非开放类；对数据安全和处理能力要求较高、时效性较强或者需要持续获取的公共数据，列入有条件开放类；其他公共数据列入无条件开放类。 非开放类公共数据依法进行脱密、脱敏处理，或者相关权利人同意开放的，可以列入无条件开放类或者有条件开放类。第十二条（开放清单） 数据开放主体应当按照年度开放重点和公共数据分级分类规则，在本市公共数据资源目录范围内，制定公共数据开放清单（以下简称开放清单），列明可以向社会开放的公共数据。通过共享等手段获取的公共数据，不纳入本单位的开放清单。 开放清单应当标注数据领域、数据摘要、数据项和数据格式等信息，明确数据的开放类型、开放条件和更新频率等。 市经济信息化部门应当会同数据开放主体建立开放清单审查机制。经审查后，开放清单应当通过开放平台予以公布。第十三条（动态调整） 数据开放主体应当在市经济信息化部门的指导下建立开放清单动态调整机制，对尚未开放的公共数据进行定期评估，及时更新开放清单，不断扩大公共数据的开放范围。第十四条（无条件开放类数据获取方式） 对列入无条件开放类的公共数据，自然人、法人和非法人组织可以通过开放平台以数据下载或者接口调用的方式直接获取。第十五条（有条件开放类数据获取方式） 对列入有条件开放类的公共数据，数据开放主体应当通过开放平台公布利用数据的技术能力和安全保障措施等条件，向符合条件的自然人、法人和非法人组织开放。 数据开放主体应当与符合条件的自然人、法人和非法人组织签订数据利用协议，明确数据利用的条件和具体要求，并按照协议约定通过数据下载、接口访问、数据沙箱等方式开放公共数据。 数据利用协议示范文本由市经济信息化部门会同市大数据中心和数据开放主体制定。第十六条（数据质量） 数据开放主体应当按照相关技术标准和要求，对列入开放清单的公共数据（以下简称开放数据）进行整理、清洗、脱敏、格式转换等处理，并根据开放清单明确的更新频率，及时更新数据。第三章　平台建设第十七条（开放平台） 市大数据中心应当依托市大数据资源平台建设开放平台。 数据开放主体应当通过开放平台开放公共数据，原则上不再新建独立的开放渠道。已经建成的开放渠道，应当按照有关规定进行整合、归并，将其纳入开放平台。第十八条（平台功能） 开放平台为数据开放主体提供数据预处理、安全加密、日志记录等数据管理功能。 开放平台为获取、使用和传播公共数据的自然人、法人和非法人组织（以下统称数据利用主体）提供数据查询、预览和获取等功能。 市大数据中心应当根据数据开放主体和数据利用主体的需求，推进开放平台技术升级、功能迭代和资源扩展，确保开放平台具备必要的服务能力。第十九条（平台规范） 市大数据中心应当制定并公布开放平台管理制度，明确数据开放主体和数据利用主体在开放平台上的行为规范和安全责任，对开放平台上开放数据的存储、传输、利用等环节建立透明化、可审计、可追溯的全过程管理机制。第二十条（行为记录） 市大数据中心应当依托开放平台，形成数据开放和利用行为的全程记录，为数据开放和利用的日常监管提供支撑。 数据开放主体应当对数据处理和数据开放情况进行记录；数据利用主体应当对有条件开放类公共数据的访问、调用和利用等情况进行记录。记录应当通过开放平台提交市大数据中心。第二十一条（数据纠错） 自然人、法人和非法人组织认为开放数据存在错误、遗漏等情形，可以通过开放平台向数据开放主体提出异议。数据开放主体经基本确认后，应当立即进行异议标注，并由数据开放主体和市大数据中心在各自职责范围内，及时处理并反馈。第二十二条（权益保护） 自然人、法人和非法人组织认为开放数据侵犯其商业秘密、个人隐私等合法权益的，可以通过开放平台告知数据开放主体，并提交相关证据材料。 数据开放主体收到相关证据材料后，认为必要的，应当立即中止开放，同时进行核实。根据核实结果，分别采取撤回数据、恢复开放或者处理后再开放等措施，并及时反馈。第四章　数据利用第二十三条（鼓励数据利用） 本市鼓励数据利用主体利用公共数据开展科技研究、咨询服务、产品开发、数据加工等活动。 数据利用主体应当遵循合法、正当的原则利用公共数据，不得损害国家利益、社会公共利益和第三方合法权益。第二十四条（成果展示与合作应用） 市经济信息化部门应当会同市大数据中心和数据开放主体通过开放平台，对社会价值或者市场价值显著的公共数据利用案例进行示范展示。 本市鼓励数据利用主体与市经济信息化部门、市大数据中心以及数据开放主体开展合作，将利用公共数据形成的各类成果用于行政监管和公共服务，提升公共管理的科学性和有效性。第二十五条（数据利用反馈与来源披露） 对有条件开放类公共数据，数据利用主体应当按照数据利用协议的约定，向数据开放主体反馈数据利用情况。 数据利用主体利用公共数据形成数据产品、研究报告、学术论文等成果的，应当在成果中注明数据来源。第二十六条（数据利用安全保障） 数据利用主体应当按照开放平台管理制度的要求和数据利用协议的约定，在利用公共数据的过程中，采取必要的安全保障措施，并接受有关部门的监督检查。第二十七条（利用监管） 数据开放主体应当建立有效的监管制度，对有条件开放类公共数据的利用情况进行跟踪，判断数据利用行为是否合法正当。 任何单位和个人可以对违法违规利用公共数据的行为向数据开放主体及有关部门举报。第二十八条（违法违规行为处理） 数据利用主体在利用公共数据的过程中有下列行为之一，市经济信息化部门应当会同市大数据中心和数据开放主体对其予以记录：（一）违反开放平台管理制度；（二）采用非法手段获取公共数据；（三）侵犯商业秘密、个人隐私等他人合法权益；（四）超出数据利用协议限制的应用场景使用公共数据；（五）违反法律、法规、规章和数据利用协议的其他行为。对存在前款行为的数据利用主体，市大数据中心和数据开放主体应当按照各自职责，采取限制或者关闭其数据获取权限等措施，并可以在开放平台对违法违规行为和处理措施予以公示。第五章　多元开放第二十九条（优化开放环境） 市经济信息化部门结合本市大数据应用和产业发展现状，通过产业政策引导、社会资本引入、应用模式创新以及优秀服务推荐、联合创新实验室等方式，推动“产学研用”协同发展，营造良好的数据开放氛围。第三十条（多元主体参与） 市经济信息化部门应当会同市大数据中心、相关行业主管部门建立多元化的数据合作交流机制，引导企业、行业协会等单位依法开放自有数据，促进公共数据和非公共数据的多维度开放和融合应用。 本市鼓励具备相应能力的企业、行业协会等专业服务机构通过开放平台提供各类数据服务。第三十一条（非公共数据交易） 市经济信息化部门应当会同相关行业主管部门制定非公共数据交易流通标准，依托数据交易机构开展非公共数据交易流通的试点示范，推动建立合法合规、安全有序的数据交易体系。第三十二条（标准体系和技术规范） 本市鼓励企业、科研机构和社会团体参与制订数据开放利用、数据安全保护等相关国家标准、行业标准、地方标准以及相关技术规范，推动形成相关行业公约，建立行业自律体系。第三十三条（国际合作交流） 本市鼓励企业、科研机构和社会团体依法与境外企业、科研机构等开展公共数据开放领域的国际合作交流，提升本市公共数据开放的创新应用能力和认知水平。第三十四条（表彰机制） 市经济信息化部门应当会同市大数据中心和相关行业主管部门对在数据技术研发、数据服务提供、数据利用实践、数据合作交流等方面有突出表现的单位和个人，按照规定给予表彰。第六章　监督保障第三十五条（安全管理职责） 市网信、公安等部门应当会同其他具有网络安全管理职能的部门建立本市公共数据开放的安全管理体系，协调处理公共数据开放重大安全事件，指导数据开放主体制定本机构的安全管理制度。 市大数据中心应当根据法律法规和相关要求，加强开放平台的安全管理，健全安全防护体系，完善安全防护措施，保障开放平台安全可靠运行。 数据开放主体应当制定并落实与公共数据分级分类开放相适应的安全管理制度，并按照相关法律法规，在数据开放前评估安全风险。第三十六条（安全保障措施监管） 数据利用主体未按照开放平台管理制度和数据利用协议落实数据安全保障措施的，市大数据中心应当提出整改要求,并暂时关闭其数据获取权限；对未按照要求进行整改的，市大数据中心应当终止对其提供数据服务。第三十七条（预警机制） 市网信、公安和保密部门应当会同数据开放主体建立公共数据开放安全预警机制，对涉密数据和敏感数据泄漏等异常情况进行监测和预警。第三十八条（应急管理） 市网信、公安部门应当建立公共数据开放应急管理制度，指导数据开放主体制定安全处置应急预案、定期组织应急演练，确保公共数据开放工作安全有序。第三十九条（组织保障） 数据开放主体应当加强公共数据开放工作的组织保障，明确牵头负责数据开放工作的机构，建立数据开放专人专岗管理制度。 市经济信息化部门应当会同市大数据中心制定公共数据开放工作培训计划，定期对数据开放工作相关机构工作人员开展培训，并纳入本市公务员培训工作体系。第四十条（资金保障） 行政事业单位开展公共数据开放所涉及的信息系统建设、改造、运维以及考核评估等相关经费，按照有关规定纳入市、区两级财政资金预算。第四十一条（考核评估） 市经济信息化部门可以委托第三方专业机构，对本市公共数据开放工作和数据利用成效等进行评估。评估结果纳入本市公共数据和一网通办管理考核。 市大数据中心应当对开放数据质量和开放平台运行情况进行监测统计，并将监测统计结果和开放平台运行报告提交市经济信息化部门，作为考核评估的依据。第七章　法律责任第四十二条（数据开放主体责任） 数据开放主体有下列行为之一，由本级人民政府或者上级主管部门责令改正；情节严重的，依法对直接负责的主管人员和其他直接责任人员给予处分：（一）未按照规定开放和更新本单位公共数据；（二）未按照规定对开放数据进行脱敏、脱密等处理；（三）不符合统一标准、新建独立开放渠道或者未按照规定将已有开放渠道纳入开放平台；（四）未按照规定处理自然人、法人和非法人组织的异议或者告知；（五）未按照规定履行数据开放职责的其他行为。第四十三条（数据利用主体责任） 数据利用主体在数据利用过程中有下列行为之一，依法追究相应法律责任：（一）未履行数据利用协议规定的义务；（二）侵犯商业秘密、个人隐私等他人合法权益；（三）利用公共数据获取非法收益；（四）未按照规定采取安全保障措施，造成危害信息安全事件；（五）违反本办法规定，依法应当追究法律责任的其他行为。第四十四条（平台管理主体责任） 市大数据中心有下列行为之一，由主管部门责令改正；情节严重的，由主管部门对直接负责的主管人员和其他直接责任人员依法给予处分：（一）未按照规定记录开放平台中公共数据开放和利用的全程行为；（二）未按照规定处理自然人、法人和非法人组织的异议或者告知；（三）未按照规定履行平台管理职责的其他行为。第四十五条（安全管理主体责任） 市网信和公安部门、市大数据中心、数据开放主体等具有网络安全管理职能的部门及其工作人员未按照规定履行安全管理职责的，由本级人民政府或者上级主管部门责令改正；情节严重的，依法对直接主管人员和其他直接责任人员给予处分。第四十六条（责任豁免） 数据开放主体按照法律、法规和规章的规定开放公共数据，并履行了监督管理职责和合理注意义务的，对因开放数据质量等问题导致数据利用主体或者其他第三方的损失，依法不承担或者免予承担相应责任。第八章　附则第四十七条（遵照执行） 水务、电力、燃气、通信、公共交通、民航、铁路等公用事业运营单位涉及公共属性的数据开放，适用本办法。法律法规另有规定的，从其规定。第四十八条（实施日期） 本办法自2019年10月1日起施行。'; 

      msg.lang = 'zh-CN'; 



      msg.onend = function(e) { 

      var msg1 = new SpeechSynthesisUtterance('上海市公共数据开放暂行办法第一章　总则第一条（目的和依据） 为了促进和规范本市公共数据开放和利用，提升政府治理能力和公共服务水平，推动数字经济发展，根据相关法律法规，结合本市实际，制定本办法。第二条（适用范围） 本市行政区域内公共数据开放及其相关管理活动，适用本办法。 涉及国家秘密的公共数据管理，按照相关保密法律、法规的规定执行。第三条（定义） 本办法所称公共数据，是指本市各级行政机关以及履行公共管理和服务职能的事业单位（以下统称公共管理和服务机构）在依法履职过程中，采集和产生的各类数据资源。 本办法所称公共数据开放，是指公共管理和服务机构在公共数据范围内，面向社会提供具备原始性、可机器读取、可供社会化再利用的数据集的公共服务。第四条（工作原则） 本市公共数据开放工作，遵循“需求导向、安全可控、分级分类、统一标准、便捷高效”的原则。第五条（职责分工） 市政府办公厅负责推动、监督本市公共数据开放工作。 市经济信息化部门负责指导协调、统筹推进本市公共数据开放、利用和相关产业发展。 市大数据中心负责本市公共数据统一开放平台（以下简称开放平台）的建设、运行和维护，并制订相关技术标准。 区人民政府确定的部门负责指导、推进和协调本行政区域内公共数据开放工作。 其他公共管理和服务机构根据相关法律、法规和规章，做好公共数据开放的相关工作。第六条（数据安全保护） 市、区人民政府及各相关部门在公共数据开放过程中，应当落实数据安全管理要求，采取措施保护商业秘密和个人隐私，防止公共数据被非法获取或者不当利用。第七条（协调机制） 市人民政府建立健全公共数据开放工作的协调机制，协调解决公共数据开放的重大事项。第八条（专家委员会） 市经济信息化部门应当建立由高校、科研机构、企业、相关部门的专家组成的公共数据开放专家委员会。 公共数据开放专家委员会负责研究论证公共数据开放中的疑难问题，评估公共数据利用风险，对公共数据开放工作提出专业建议。第二章　开放机制第九条（数据开放主体） 市人民政府各部门、区人民政府以及其他公共管理和服务机构（以下统称数据开放主体）分别负责本系统、本行政区域和本单位的公共数据开放。 对于纳入开放范围的公共数据,应当在本市公共数据资源目录中列明数据开放主体。第十条（开放重点） 市经济信息化部门应当根据本市经济社会发展需要，确定年度公共数据开放重点。与民生紧密相关、社会迫切需要、行业增值潜力显著和产业战略意义重大的公共数据，应当优先纳入公共数据开放重点。 市经济信息化部门在确定公共数据开放重点时，应当听取相关行业主管部门和社会公众的意见。 自然人、法人和非法人组织可以通过开放平台对公共数据的开放范围提出需求和意见建议。第十一条（分级分类） 市经济信息化部门应当会同市大数据中心结合公共数据安全要求、个人信息保护要求和应用要求等因素，制定本市公共数据分级分类规则。数据开放主体应当按照分级分类规则，结合行业、区域特点，制定相应的实施细则，并对公共数据进行分级分类，确定开放类型、开放条件和监管措施。 对涉及商业秘密、个人隐私，或者法律法规规定不得开放的公共数据，列入非开放类；对数据安全和处理能力要求较高、时效性较强或者需要持续获取的公共数据，列入有条件开放类；其他公共数据列入无条件开放类。 非开放类公共数据依法进行脱密、脱敏处理，或者相关权利人同意开放的，可以列入无条件开放类或者有条件开放类。第十二条（开放清单） 数据开放主体应当按照年度开放重点和公共数据分级分类规则，在本市公共数据资源目录范围内，制定公共数据开放清单（以下简称开放清单），列明可以向社会开放的公共数据。通过共享等手段获取的公共数据，不纳入本单位的开放清单。 开放清单应当标注数据领域、数据摘要、数据项和数据格式等信息，明确数据的开放类型、开放条件和更新频率等。 市经济信息化部门应当会同数据开放主体建立开放清单审查机制。经审查后，开放清单应当通过开放平台予以公布。第十三条（动态调整） 数据开放主体应当在市经济信息化部门的指导下建立开放清单动态调整机制，对尚未开放的公共数据进行定期评估，及时更新开放清单，不断扩大公共数据的开放范围。第十四条（无条件开放类数据获取方式） 对列入无条件开放类的公共数据，自然人、法人和非法人组织可以通过开放平台以数据下载或者接口调用的方式直接获取。第十五条（有条件开放类数据获取方式） 对列入有条件开放类的公共数据，数据开放主体应当通过开放平台公布利用数据的技术能力和安全保障措施等条件，向符合条件的自然人、法人和非法人组织开放。 数据开放主体应当与符合条件的自然人、法人和非法人组织签订数据利用协议，明确数据利用的条件和具体要求，并按照协议约定通过数据下载、接口访问、数据沙箱等方式开放公共数据。 数据利用协议示范文本由市经济信息化部门会同市大数据中心和数据开放主体制定。第十六条（数据质量） 数据开放主体应当按照相关技术标准和要求，对列入开放清单的公共数据（以下简称开放数据）进行整理、清洗、脱敏、格式转换等处理，并根据开放清单明确的更新频率，及时更新数据。第三章　平台建设第十七条（开放平台） 市大数据中心应当依托市大数据资源平台建设开放平台。 数据开放主体应当通过开放平台开放公共数据，原则上不再新建独立的开放渠道。已经建成的开放渠道，应当按照有关规定进行整合、归并，将其纳入开放平台。第十八条（平台功能） 开放平台为数据开放主体提供数据预处理、安全加密、日志记录等数据管理功能。 开放平台为获取、使用和传播公共数据的自然人、法人和非法人组织（以下统称数据利用主体）提供数据查询、预览和获取等功能。 市大数据中心应当根据数据开放主体和数据利用主体的需求，推进开放平台技术升级、功能迭代和资源扩展，确保开放平台具备必要的服务能力。第十九条（平台规范） 市大数据中心应当制定并公布开放平台管理制度，明确数据开放主体和数据利用主体在开放平台上的行为规范和安全责任，对开放平台上开放数据的存储、传输、利用等环节建立透明化、可审计、可追溯的全过程管理机制。第二十条（行为记录） 市大数据中心应当依托开放平台，形成数据开放和利用行为的全程记录，为数据开放和利用的日常监管提供支撑。 数据开放主体应当对数据处理和数据开放情况进行记录；数据利用主体应当对有条件开放类公共数据的访问、调用和利用等情况进行记录。记录应当通过开放平台提交市大数据中心。第二十一条（数据纠错） 自然人、法人和非法人组织认为开放数据存在错误、遗漏等情形，可以通过开放平台向数据开放主体提出异议。数据开放主体经基本确认后，应当立即进行异议标注，并由数据开放主体和市大数据中心在各自职责范围内，及时处理并反馈。第二十二条（权益保护） 自然人、法人和非法人组织认为开放数据侵犯其商业秘密、个人隐私等合法权益的，可以通过开放平台告知数据开放主体，并提交相关证据材料。 数据开放主体收到相关证据材料后，认为必要的，应当立即中止开放，同时进行核实。根据核实结果，分别采取撤回数据、恢复开放或者处理后再开放等措施，并及时反馈。第四章　数据利用第二十三条（鼓励数据利用） 本市鼓励数据利用主体利用公共数据开展科技研究、咨询服务、产品开发、数据加工等活动。 数据利用主体应当遵循合法、正当的原则利用公共数据，不得损害国家利益、社会公共利益和第三方合法权益。第二十四条（成果展示与合作应用） 市经济信息化部门应当会同市大数据中心和数据开放主体通过开放平台，对社会价值或者市场价值显著的公共数据利用案例进行示范展示。 本市鼓励数据利用主体与市经济信息化部门、市大数据中心以及数据开放主体开展合作，将利用公共数据形成的各类成果用于行政监管和公共服务，提升公共管理的科学性和有效性。第二十五条（数据利用反馈与来源披露） 对有条件开放类公共数据，数据利用主体应当按照数据利用协议的约定，向数据开放主体反馈数据利用情况。 数据利用主体利用公共数据形成数据产品、研究报告、学术论文等成果的，应当在成果中注明数据来源。第二十六条（数据利用安全保障） 数据利用主体应当按照开放平台管理制度的要求和数据利用协议的约定，在利用公共数据的过程中，采取必要的安全保障措施，并接受有关部门的监督检查。第二十七条（利用监管） 数据开放主体应当建立有效的监管制度，对有条件开放类公共数据的利用情况进行跟踪，判断数据利用行为是否合法正当。 任何单位和个人可以对违法违规利用公共数据的行为向数据开放主体及有关部门举报。第二十八条（违法违规行为处理） 数据利用主体在利用公共数据的过程中有下列行为之一，市经济信息化部门应当会同市大数据中心和数据开放主体对其予以记录：（一）违反开放平台管理制度；（二）采用非法手段获取公共数据；（三）侵犯商业秘密、个人隐私等他人合法权益；（四）超出数据利用协议限制的应用场景使用公共数据；（五）违反法律、法规、规章和数据利用协议的其他行为。对存在前款行为的数据利用主体，市大数据中心和数据开放主体应当按照各自职责，采取限制或者关闭其数据获取权限等措施，并可以在开放平台对违法违规行为和处理措施予以公示。第五章　多元开放第二十九条（优化开放环境） 市经济信息化部门结合本市大数据应用和产业发展现状，通过产业政策引导、社会资本引入、应用模式创新以及优秀服务推荐、联合创新实验室等方式，推动“产学研用”协同发展，营造良好的数据开放氛围。第三十条（多元主体参与） 市经济信息化部门应当会同市大数据中心、相关行业主管部门建立多元化的数据合作交流机制，引导企业、行业协会等单位依法开放自有数据，促进公共数据和非公共数据的多维度开放和融合应用。 本市鼓励具备相应能力的企业、行业协会等专业服务机构通过开放平台提供各类数据服务。第三十一条（非公共数据交易） 市经济信息化部门应当会同相关行业主管部门制定非公共数据交易流通标准，依托数据交易机构开展非公共数据交易流通的试点示范，推动建立合法合规、安全有序的数据交易体系。第三十二条（标准体系和技术规范） 本市鼓励企业、科研机构和社会团体参与制订数据开放利用、数据安全保护等相关国家标准、行业标准、地方标准以及相关技术规范，推动形成相关行业公约，建立行业自律体系。第三十三条（国际合作交流） 本市鼓励企业、科研机构和社会团体依法与境外企业、科研机构等开展公共数据开放领域的国际合作交流，提升本市公共数据开放的创新应用能力和认知水平。第三十四条（表彰机制） 市经济信息化部门应当会同市大数据中心和相关行业主管部门对在数据技术研发、数据服务提供、数据利用实践、数据合作交流等方面有突出表现的单位和个人，按照规定给予表彰。第六章　监督保障第三十五条（安全管理职责） 市网信、公安等部门应当会同其他具有网络安全管理职能的部门建立本市公共数据开放的安全管理体系，协调处理公共数据开放重大安全事件，指导数据开放主体制定本机构的安全管理制度。 市大数据中心应当根据法律法规和相关要求，加强开放平台的安全管理，健全安全防护体系，完善安全防护措施，保障开放平台安全可靠运行。 数据开放主体应当制定并落实与公共数据分级分类开放相适应的安全管理制度，并按照相关法律法规，在数据开放前评估安全风险。第三十六条（安全保障措施监管） 数据利用主体未按照开放平台管理制度和数据利用协议落实数据安全保障措施的，市大数据中心应当提出整改要求,并暂时关闭其数据获取权限；对未按照要求进行整改的，市大数据中心应当终止对其提供数据服务。第三十七条（预警机制） 市网信、公安和保密部门应当会同数据开放主体建立公共数据开放安全预警机制，对涉密数据和敏感数据泄漏等异常情况进行监测和预警。第三十八条（应急管理） 市网信、公安部门应当建立公共数据开放应急管理制度，指导数据开放主体制定安全处置应急预案、定期组织应急演练，确保公共数据开放工作安全有序。第三十九条（组织保障） 数据开放主体应当加强公共数据开放工作的组织保障，明确牵头负责数据开放工作的机构，建立数据开放专人专岗管理制度。 市经济信息化部门应当会同市大数据中心制定公共数据开放工作培训计划，定期对数据开放工作相关机构工作人员开展培训，并纳入本市公务员培训工作体系。第四十条（资金保障） 行政事业单位开展公共数据开放所涉及的信息系统建设、改造、运维以及考核评估等相关经费，按照有关规定纳入市、区两级财政资金预算。第四十一条（考核评估） 市经济信息化部门可以委托第三方专业机构，对本市公共数据开放工作和数据利用成效等进行评估。评估结果纳入本市公共数据和一网通办管理考核。 市大数据中心应当对开放数据质量和开放平台运行情况进行监测统计，并将监测统计结果和开放平台运行报告提交市经济信息化部门，作为考核评估的依据。第七章　法律责任第四十二条（数据开放主体责任） 数据开放主体有下列行为之一，由本级人民政府或者上级主管部门责令改正；情节严重的，依法对直接负责的主管人员和其他直接责任人员给予处分：（一）未按照规定开放和更新本单位公共数据；（二）未按照规定对开放数据进行脱敏、脱密等处理；（三）不符合统一标准、新建独立开放渠道或者未按照规定将已有开放渠道纳入开放平台；（四）未按照规定处理自然人、法人和非法人组织的异议或者告知；（五）未按照规定履行数据开放职责的其他行为。第四十三条（数据利用主体责任） 数据利用主体在数据利用过程中有下列行为之一，依法追究相应法律责任：（一）未履行数据利用协议规定的义务；（二）侵犯商业秘密、个人隐私等他人合法权益；（三）利用公共数据获取非法收益；（四）未按照规定采取安全保障措施，造成危害信息安全事件；（五）违反本办法规定，依法应当追究法律责任的其他行为。第四十四条（平台管理主体责任） 市大数据中心有下列行为之一，由主管部门责令改正；情节严重的，由主管部门对直接负责的主管人员和其他直接责任人员依法给予处分：（一）未按照规定记录开放平台中公共数据开放和利用的全程行为；（二）未按照规定处理自然人、法人和非法人组织的异议或者告知；（三）未按照规定履行平台管理职责的其他行为。第四十五条（安全管理主体责任） 市网信和公安部门、市大数据中心、数据开放主体等具有网络安全管理职能的部门及其工作人员未按照规定履行安全管理职责的，由本级人民政府或者上级主管部门责令改正；情节严重的，依法对直接主管人员和其他直接责任人员给予处分。第四十六条（责任豁免） 数据开放主体按照法律、法规和规章的规定开放公共数据，并履行了监督管理职责和合理注意义务的，对因开放数据质量等问题导致数据利用主体或者其他第三方的损失，依法不承担或者免予承担相应责任。第八章　附则第四十七条（遵照执行） 水务、电力、燃气、通信、公共交通、民航、铁路等公用事业运营单位涉及公共属性的数据开放，适用本办法。法律法规另有规定的，从其规定。第四十八条（实施日期） 本办法自2019年10月1日起施行。'); 

      msg1.voice = speechSynthesis.getVoices().filter(function(voice) { return voice.name == 'Whisper'; })[0]; 

      msg1.pitch = 1; //0 to 2 

      msg1.rate= 1; //0 to 2 

      // start your audio loop. 

      speechSynthesis.speak(msg1); 

      console.log('Finished in ' + e.elapsedTime + ' seconds.'); 

      }; 



      speechSynthesis.speak(msg); 
    },
  },
}
</script>
<style lang="scss">
@import '../assets/scss/_variables.scss';

.pagination-home{
  .swiper-pagination-bullet{
    opacity: 1;
    border-radius: .153846rem;
    background: map-get($colors, wihte);
  }
  &.swiper-pagination-bullet-active{
    background-color: map-get($colors, 'info');
  }
}

.nav-icons{
  border-top: 1px solid $border-color;
  border-bottom: 1px solid $border-color;
  .nav-item{
    width: 25%;
    border-left: 1px solid $border-color;
    &:nth-child(4n+1){
      border-left: none;
    }
  }
  
}
.qrcode-content{
  .ant-modal-body{
    text-align: center;
  }
  .code{
    display: inline-block;
    img{
      display: inline-block !important;
    }
  }
}

</style>